# 项目说明

## 1. 项目概述
- 项目原名 `claude-code-router`，现统一更名为 **KTAI Router**。
- 主要功能：将 Claude Code 的请求路由至多家模型服务商，并支持自定义请求/响应转换。
- 代码目录位于 `project/ktai-router`，所有生成的日志与配置默认写入 `~/.ktai-router/`。

## 2. 功能亮点
- **多模型路由**：按场景/指令自动路由到不同模型。
- **多提供商适配**：封装 OpenRouter、DeepSeek、Ollama、Gemini、火山引擎等。
- **统一 Transformer**：通过中间层规范请求/响应格式，便于扩展。
- **插件机制**：支持在本地 `~/.ktai-router/plugins/` 目录下加载自定义逻辑。

## 3. 本地开发流程
```bash
cd project/ktai-router
npm install
npm run build
```
- 构建后 CLI 入口为 `dist/cli.js`，命令名为 `ktai-router`。
- 若需调试，可使用 `node dist/cli.js start` 启动本地路由服务。

## 4. 配置迁移指引
- 历史版本使用 `~/.claude-code-router/` 目录；需手动迁移到 `~/.ktai-router/`。
- 常见文件：`config.json`、`custom-router.js`、`plugins/` 目录、自定义日志。
- 迁移示例：
  ```bash
  mv ~/.claude-code-router ~/.ktai-router
  ```

## 5. 替换线上 Fork 仓库
如需将 Fork 的原仓库完全替换为本地最新版本，可按以下步骤操作：
1. **设置远程地址**（假设 Fork 仓库地址为 `git@github.com:<your-org>/ktai-router.git`）：
   ```bash
   git remote remove origin
   git remote add origin git@github.com:<your-org>/ktai-router.git
   ```
2. **重命名 GitHub 仓库**：在 GitHub 仓库设置页面将仓库名改为 `ktai-router`，并更新项目描述。
3. **同步主分支**：
   ```bash
   git checkout main
   git add .
   git commit -m "chore: rename project to ktai-router"
   git push origin main --force
   ```
   > 若需保留历史，可在推送前将旧分支备份为 `legacy/claude-code-router`。
4. **检查发布配置**：
   - 若继续发布到 npm，需要确认包名 `ktai-router` 是否可用，或改为私有作用域。
   - 更新 README 中的安装命令以匹配实际发布包。

## 6. 线上部署提醒
- 部署脚本中若写死旧路径（如 `.claude-code-router`），必须同步更新。
- 现有后台进程（如 PM2、systemd）需要修改工作目录和可执行文件名称。
- 如果使用 Docker 镜像，请重新构建并推送：
  ```bash
  docker build -t <registry>/ktai-router:latest .
  docker push <registry>/ktai-router:latest
  ```

## 7. 文档与记录
- Markdown 项目说明、README（中英）与 blog 已更新品牌名称。
- 内部知识库新增文档：《KTAI Router 重命名记录》（MrDoc ID 556），记录调整细节与验证步骤。

## 8. 后续计划建议
- 完成 npm 包与 Docker 镜像的重新发布。
- 在 GitHub Releases 中发布新的版本说明，强调目录与配置迁移。
- 根据用户反馈补充更多中文教程与示例配置。
